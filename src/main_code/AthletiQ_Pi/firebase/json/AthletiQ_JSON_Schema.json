{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "AthletiQ JSON Schema",
  "type": "object",

  "required": [
    "userID",
    "timestamp",
    "mode",
    "ballTrajectory",
    "jointAngles",
    "ballReleaseMoment"
  ],

  "properties": {
    "userID": {
      "type": "string",
      "pattern": "^[0-9]{6}$",
      "description": "Unique 6-digit user identifier"
    },

    "timestamp": {
      "type": "object",
      "required": ["videoStart", "shotTime", "videoEnd"],
      "properties": {
        "videoStart": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}$",
          "description": "Format: YYYY-MM-DD HH:MM:SS"
        },
        "shotTime": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}$",
          "description": "Format: YYYY-MM-DD HH:MM:SS"
        },
        "videoEnd": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}$",
          "description": "Format: YYYY-MM-DD HH:MM:SS"
        }
      }
    },

    "mode": {
      "type": "string",
      "enum": ["Side", "Front"]
    },

    "ballTrajectory": {
      "description": "Ball trajectory in pixel coordinates with origin at upper left corner (side mode only)",
      "type": ["array", "null"],
      "items": {
        "type": "array",
        "minItems": 2,
        "maxItems": 2,
        "items": {
          "type": "number"
        }
      }
    },

    "jointAngles": {
      "type": "object",
      "required": ["elbow", "wrist"],
      "properties": {
        "elbow": {
          "type": ["number", "null"],
          "description": "Elbow angle in degrees (side mode only)"
        },
        "wrist": {
          "type": ["number", "null"],
          "description": "Wrist angle in degrees (side mode only)"
        }
      }
    },

    "ballReleaseMoment": {
      "type": "object",
      "required": ["height", "ballLocation"],
      "properties": {
        "height": {
          "type": "number",
          "description": "Player height in pixels within the frame"
        },
        "ballLocation": {
          "type": "object",
          "required": ["horizontal", "vertical"],
          "properties": {
            "horizontal": {
              "type": ["number", "null"],
              "description": "Horizontal ball position within shoulder width with -1 being left and 1 being right (front mode only)"
            },
            "vertical": {
              "type": "number",
              "description": "Vertical ball position normalized by player height"
            }
          }
        }
      }
    }
  },

  "allOf": [
    {
      "if": {
        "properties": { "mode": { "const": "Side" } }
      },
      "then": {
        "properties": {
          "ballReleaseMoment": {
            "properties": {
              "ballLocation": {
                "properties": {
                  "horizontal": { "const": null }
                }
              }
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": { "mode": { "const": "Front" } }
      },
      "then": {
        "properties": {
          "ballTrajectory": { "const": null },
          "jointAngles": {
            "properties": {
              "elbow": { "const": null },
              "wrist": { "const": null }
            }
          }
        }
      }
    }
  ]
}
